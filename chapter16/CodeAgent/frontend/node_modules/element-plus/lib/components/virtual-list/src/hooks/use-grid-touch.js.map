{"version":3,"file":"use-grid-touch.js","sources":["../../../../../../../packages/components/virtual-list/src/hooks/use-grid-touch.ts"],"sourcesContent":["import { ref, unref } from 'vue'\nimport { useEventListener } from '@vueuse/core'\nimport { cAF, rAF } from '@element-plus/utils'\n\nimport type { ComputedRef, Ref } from 'vue'\nimport type { GridScrollOptions, GridStates } from '../types'\n\nexport const useGridTouch = (\n  windowRef: Ref<HTMLElement | undefined>,\n  states: Ref<GridStates>,\n  scrollTo: (scrollOptions: GridScrollOptions) => void,\n  estimatedTotalWidth: ComputedRef<number>,\n  estimatedTotalHeight: ComputedRef<number>,\n  parsedWidth: ComputedRef<number>,\n  parsedHeight: ComputedRef<number>\n) => {\n  const touchStartX = ref(0)\n  const touchStartY = ref(0)\n  let frameHandle: number | undefined\n  let deltaX = 0\n  let deltaY = 0\n\n  const handleTouchStart = (event: TouchEvent) => {\n    cAF(frameHandle!)\n    touchStartX.value = event.touches[0].clientX\n    touchStartY.value = event.touches[0].clientY\n    deltaX = 0\n    deltaY = 0\n  }\n\n  const handleTouchMove = (event: TouchEvent) => {\n    event.preventDefault()\n    cAF(frameHandle!)\n\n    deltaX += touchStartX.value - event.touches[0].clientX\n    deltaY += touchStartY.value - event.touches[0].clientY\n    touchStartX.value = event.touches[0].clientX\n    touchStartY.value = event.touches[0].clientY\n\n    frameHandle = rAF(() => {\n      const maxScrollLeft = estimatedTotalWidth.value - unref(parsedWidth)\n      const maxScrollTop = estimatedTotalHeight.value - unref(parsedHeight)\n\n      const safeScrollLeft = Math.min(\n        states.value.scrollLeft + deltaX,\n        maxScrollLeft\n      )\n      const safeScrollTop = Math.min(\n        states.value.scrollTop + deltaY,\n        maxScrollTop\n      )\n\n      scrollTo({\n        scrollLeft: safeScrollLeft,\n        scrollTop: safeScrollTop,\n      })\n\n      deltaX = 0\n      deltaY = 0\n    })\n  }\n\n  useEventListener(windowRef, 'touchstart', handleTouchStart, {\n    passive: true,\n  })\n  useEventListener(windowRef, 'touchmove', handleTouchMove, {\n    passive: false,\n  })\n\n  return {\n    touchStartX,\n    touchStartY,\n    handleTouchStart,\n    handleTouchMove,\n  }\n}\n"],"names":["ref","cAF","rAF","unref","useEventListener"],"mappings":";;;;;;;;AAGY,MAAC,YAAY,GAAG,CAAC,SAAS,EAAE,MAAM,EAAE,QAAQ,EAAE,mBAAmB,EAAE,oBAAoB,EAAE,WAAW,EAAE,YAAY,KAAK;AACnI,EAAE,MAAM,WAAW,GAAGA,OAAG,CAAC,CAAC,CAAC,CAAC;AAC7B,EAAE,MAAM,WAAW,GAAGA,OAAG,CAAC,CAAC,CAAC,CAAC;AAC7B,EAAE,IAAI,WAAW,CAAC;AAClB,EAAE,IAAI,MAAM,GAAG,CAAC,CAAC;AACjB,EAAE,IAAI,MAAM,GAAG,CAAC,CAAC;AACjB,EAAE,MAAM,gBAAgB,GAAG,CAAC,KAAK,KAAK;AACtC,IAAIC,OAAG,CAAC,WAAW,CAAC,CAAC;AACrB,IAAI,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AACjD,IAAI,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AACjD,IAAI,MAAM,GAAG,CAAC,CAAC;AACf,IAAI,MAAM,GAAG,CAAC,CAAC;AACf,GAAG,CAAC;AACJ,EAAE,MAAM,eAAe,GAAG,CAAC,KAAK,KAAK;AACrC,IAAI,KAAK,CAAC,cAAc,EAAE,CAAC;AAC3B,IAAIA,OAAG,CAAC,WAAW,CAAC,CAAC;AACrB,IAAI,MAAM,IAAI,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AAC3D,IAAI,MAAM,IAAI,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AAC3D,IAAI,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AACjD,IAAI,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AACjD,IAAI,WAAW,GAAGC,OAAG,CAAC,MAAM;AAC5B,MAAM,MAAM,aAAa,GAAG,mBAAmB,CAAC,KAAK,GAAGC,SAAK,CAAC,WAAW,CAAC,CAAC;AAC3E,MAAM,MAAM,YAAY,GAAG,oBAAoB,CAAC,KAAK,GAAGA,SAAK,CAAC,YAAY,CAAC,CAAC;AAC5E,MAAM,MAAM,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,EAAE,aAAa,CAAC,CAAC;AACvF,MAAM,MAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,GAAG,MAAM,EAAE,YAAY,CAAC,CAAC;AACpF,MAAM,QAAQ,CAAC;AACf,QAAQ,UAAU,EAAE,cAAc;AAClC,QAAQ,SAAS,EAAE,aAAa;AAChC,OAAO,CAAC,CAAC;AACT,MAAM,MAAM,GAAG,CAAC,CAAC;AACjB,MAAM,MAAM,GAAG,CAAC,CAAC;AACjB,KAAK,CAAC,CAAC;AACP,GAAG,CAAC;AACJ,EAAEC,qBAAgB,CAAC,SAAS,EAAE,YAAY,EAAE,gBAAgB,EAAE;AAC9D,IAAI,OAAO,EAAE,IAAI;AACjB,GAAG,CAAC,CAAC;AACL,EAAEA,qBAAgB,CAAC,SAAS,EAAE,WAAW,EAAE,eAAe,EAAE;AAC5D,IAAI,OAAO,EAAE,KAAK;AAClB,GAAG,CAAC,CAAC;AACL,EAAE,OAAO;AACT,IAAI,WAAW;AACf,IAAI,WAAW;AACf,IAAI,gBAAgB;AACpB,IAAI,eAAe;AACnB,GAAG,CAAC;AACJ;;;;"}